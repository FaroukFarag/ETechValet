<header class="header" [class.collapsed]="sidebarCollapsed">
  <div class="header-content">
    <button class="sidebar-toggle" (click)="onToggleSidebar()">
      <span class="toggle-icon">â˜°</span>
    </button>
    <h1 class="header-title">Valet System</h1>
    
    <div class="site-selector">
      <button class="site-dropdown-btn" (click)="toggleSiteDropdown()" title="Select Site">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
          <circle cx="12" cy="10" r="3"></circle>
        </svg>
        <span class="site-name">{{ selectedSite ? (selectedSite.siteName || selectedSite.name) : 'Select Site' }}</span>
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="chevron">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </button>
      <div class="site-dropdown" *ngIf="isSiteDropdownOpen">
        <div class="dropdown-header">Select Site</div>
        <div *ngIf="isLoadingSites" class="no-sites">Loading sites...</div>
        <div *ngIf="!isLoadingSites && loadSitesError" class="no-sites error">{{ loadSitesError }}</div>
        <button 
          *ngFor="let site of sites" 
          class="site-dropdown-item" 
          [class.active]="selectedSite?.id === site.id"
          (click)="selectSite(site)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
          <span>{{ site.siteName || site.name || 'Unnamed Site' }}</span>
          <svg *ngIf="selectedSite?.id === site.id" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="check-icon">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
        </button>
        <div *ngIf="!isLoadingSites && !loadSitesError && sites.length === 0" class="no-sites">No sites available</div>
      </div>
    </div>
    
    <div class="header-actions">
      <button class="action-btn search-btn">
        <span class="icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
          </svg>
        </span>
      </button>
      <button class="action-btn notification-btn">
        <span class="icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
          </svg>
        </span>
      </button>
      <div class="profile-dropdown-container">
        <button class="user-icon-btn" (click)="toggleProfileDropdown()" title="Profile">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </button>
        <div class="profile-dropdown" *ngIf="isProfileDropdownOpen">
          <button class="dropdown-item" (click)="changePassword()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="11" width="18" height="11" rx="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            <span>Change Password</span>
          </button>
          <button class="dropdown-item" (click)="logout()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16 17 21 12 16 7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            <span>Logout</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</header>
